apply plugin: 'java'
apply plugin: 'eclipse'

repositories {
    mavenCentral()
}

dependencies {
    if (findProperty('is_built_from_main_bookmap_project')) {
        compile fileTree(dir: "${main_libs}", include: ['*.jar'])
        compile project(':Level1Api')
        compile project(':SimplifiedApiWrapper')
    } else {
        compile files('C:/Program Files/Bookmap/lib/bm-l1api.jar')
        compile files('C:/Program Files/Bookmap/lib/bm-l1api-javadoc.jar')
        compile files('C:/Program Files/Bookmap/lib/bm-simplified-api-wrapper.jar')
        compile files('C:/Program Files/Bookmap/lib/bm-simplified-api-wrapper-javadoc.jar')

        compileOnly group: 'org.apache.commons', name: 'commons-lang3', version: '3.4'
    }
}

jar {
    archiveName 'bm-strategies.jar'
}

eclipse {
    if (!findProperty('is_built_from_main_bookmap_project')) {
        classpath {
            file {
                whenMerged { cp ->
                    def fileReferenceFactory = new org.gradle.plugins.ide.eclipse.model.internal.FileReferenceFactory()
                    def l1ApiEntry = cp.entries.find{ entry -> entry.path.endsWith('bm-l1api.jar') }
                    l1ApiEntry.javadocPath = fileReferenceFactory.fromFile(file('C:/Program Files/Bookmap/lib/bm-l1api-javadoc.jar'))
                    def simplifiedWrapperEntry = cp.entries.find{ entry -> entry.path.endsWith('bm-simplified-api-wrapper.jar') }
                    simplifiedWrapperEntry.javadocPath = fileReferenceFactory.fromFile(file('C:/Program Files/Bookmap/lib/bm-simplified-api-wrapper-javadoc.jar'))
                }
            }
        }
    }
}